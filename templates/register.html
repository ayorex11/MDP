<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - MDP Predictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>üìù Register</h1>
                <p>Create your MDP Cyber-Attack Predictor account</p>
            </div>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <form method="POST" action="{{ url_for('register') }}" class="auth-form" id="registerForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input 
                        type="text" 
                        id="username" 
                        name="username" 
                        class="form-input" 
                        required
                        autofocus
                        minlength="3"
                        maxlength="80"
                        pattern="[a-zA-Z0-9_]+"
                        placeholder="Choose a username (letters, numbers, underscore)"
                    >
                    <small>3-80 characters, alphanumeric and underscore only</small>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        class="form-input" 
                        required
                        placeholder="your.email@example.com"
                    >
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <div class="password-input-wrapper">
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            class="form-input password-input" 
                            required
                            minlength="8"
                            placeholder="Choose a strong password"
                        >
                        <span class="password-toggle" onclick="togglePassword('password', this)">
                            üëÅÔ∏è
                        </span>
                    </div>
                    <div class="password-strength" id="passwordStrength"></div>
                    <small>Minimum 8 characters, include uppercase, lowercase, number, and special character</small>
                </div>

                <div class="form-group">
                    <label for="confirm_password">Confirm Password</label>
                    <div class="password-input-wrapper">
                        <input 
                            type="password" 
                            id="confirm_password" 
                            name="confirm_password" 
                            class="form-input password-input" 
                            required
                            placeholder="Re-enter your password"
                        >
                        <span class="password-toggle" onclick="togglePassword('confirm_password', this)">
                            üëÅÔ∏è
                        </span>
                    </div>
                    <div id="passwordMatch"></div>
                </div>

                <button type="submit" class="btn btn-primary btn-block" id="submitBtn">Create Account</button>
            </form>

            <div class="auth-footer">
                <p>Already have an account? <a href="{{ url_for('login') }}">Login here</a></p>
                <p><a href="{{ url_for('index') }}">‚Üê Back to Home</a></p>
            </div>
        </div>
    </div>

    <script>
        // Toggle password visibility
        function togglePassword(fieldId, icon) {
            const field = document.getElementById(fieldId);
            if (field.type === 'password') {
                field.type = 'text';
                icon.textContent = 'üôà';
            } else {
                field.type = 'password';
                icon.textContent = 'üëÅÔ∏è';
            }
        }

        // Password strength checker
        const passwordInput = document.getElementById('password');
        const strengthDiv = document.getElementById('passwordStrength');
        
        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            let feedback = [];
            
            // Check length
            if (password.length >= 8) strength++;
            else feedback.push('at least 8 characters');
            
            // Check for lowercase
            if (/[a-z]/.test(password)) strength++;
            else feedback.push('lowercase letter');
            
            // Check for uppercase
            if (/[A-Z]/.test(password)) strength++;
            else feedback.push('uppercase letter');
            
            // Check for numbers
            if (/[0-9]/.test(password)) strength++;
            else feedback.push('number');
            
            // Check for special characters
            if (/[^a-zA-Z0-9]/.test(password)) strength++;
            else feedback.push('special character');
            
            // Display strength
            if (password.length === 0) {
                strengthDiv.innerHTML = '';
            } else if (strength <= 2) {
                strengthDiv.innerHTML = '<span style="color: #f44336;">‚ùå Weak - Add: ' + feedback.join(', ') + '</span>';
            } else if (strength <= 3) {
                strengthDiv.innerHTML = '<span style="color: #ff9800;">‚ö†Ô∏è Medium - Add: ' + feedback.join(', ') + '</span>';
            } else if (strength <= 4) {
                strengthDiv.innerHTML = '<span style="color: #2196f3;">‚úì Good</span>';
            } else {
                strengthDiv.innerHTML = '<span style="color: #4caf50;">‚úì‚úì Strong</span>';
            }
        });

        // Password confirmation validation
        const confirmInput = document.getElementById('confirm_password');
        const matchDiv = document.getElementById('passwordMatch');
        
        confirmInput.addEventListener('input', function() {
            const password = passwordInput.value;
            const confirm = this.value;
            
            if (confirm.length === 0) {
                matchDiv.innerHTML = '';
            } else if (password === confirm) {
                matchDiv.innerHTML = '<span style="color: #4caf50; font-size: 0.9rem;">‚úì Passwords match</span>';
            } else {
                matchDiv.innerHTML = '<span style="color: #f44336; font-size: 0.9rem;">‚úó Passwords do not match</span>';
            }
        });

        // Form submission validation
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            const password = passwordInput.value;
            const confirmPassword = confirmInput.value;
            
            // Check if passwords match
            if (password !== confirmPassword) {
                e.preventDefault();
                alert('Passwords do not match!');
                return false;
            }
            
            // Check password strength requirements
            const hasLower = /[a-z]/.test(password);
            const hasUpper = /[A-Z]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const hasSpecial = /[^a-zA-Z0-9]/.test(password);
            const isLongEnough = password.length >= 8;
            
            if (!isLongEnough || !hasLower || !hasUpper || !hasNumber || !hasSpecial) {
                e.preventDefault();
                alert('Password must be at least 8 characters and include uppercase, lowercase, number, and special character.');
                return false;
            }
        });
    </script>
</body>
</html>

